angular.module("jkuri.touchspin",[]).directive("ngTouchSpin",["$timeout","$interval","$document",function(e,t,n){"use strict"
var a={left:37,right:39},i=function(e){e.min=e.min||0,e.max=e.max||100,e.step=e.step||1,e.prefix=e.prefix||void 0,e.postfix=e.postfix||void 0,e.decimals=e.decimals||0,e.stepInterval=e.stepInterval||100,e.stepIntervalDelay=e.stepIntervalDelay||500,e.initval=e.initval||"",e.val=e.value||e.initval}
return{restrict:"EA",require:"?ngModel",scope:{min:"@?",max:"@?",step:"@?",prefix:"@?",postfix:"@?",decimals:"@?",stepInterval:"@?",stepIntervalDelay:"@?",initval:"@?",value:"@?"},replace:!0,link:function(s,l,o,c){var p,u,r,v,d=n.find("body")
s.decrement=function(){r=s.val
var e=parseFloat(parseFloat(Number(s.val))-parseFloat(s.step)).toFixed(s.decimals)
return e<s.min?(e=parseFloat(s.min).toFixed(s.decimals),s.val=e,void c.$setViewValue(e)):(s.val=e,void c.$setViewValue(e))},s.increment=function(){r=s.val
var e=parseFloat(parseFloat(Number(s.val))+parseFloat(s.step)).toFixed(s.decimals)
e>s.max||(s.val=e,c.$setViewValue(e))},s.startSpinUp=function(){s.checkValue(),s.increment(),v=Date.now(),s.stopSpin(),e(function(){u=t(function(){s.increment()},s.stepInterval)},s.stepIntervalDelay)},s.startSpinDown=function(){s.checkValue(),s.decrement(),v=Date.now()
e(function(){u=t(function(){s.decrement()},s.stepInterval)},s.stepIntervalDelay)},s.stopSpin=function(){Date.now()-v>s.stepIntervalDelay?(e.cancel(p),t.cancel(u)):e(function(){e.cancel(p),t.cancel(u)},s.stepIntervalDelay)},s.checkValue=function(){var e
""===s.val||s.val.match(/^-?(?:\d+|\d*\.\d+)$/i)||(e=""!==r?parseFloat(r).toFixed(s.decimals):parseFloat(s.min).toFixed(s.decimals),s.val=e,c.$setViewValue(e)),s.focused=!1},s.focus=function(){s.focused=!0},c.$render=function(){s.val=c.$viewValue},s.$watch("initval",function(e){void 0!==e&&void 0===r&&(i(s),r=s.val,c.$setViewValue(s.val),s.focused=!1)}),d.bind("keydown",function(e){if(s.focused){e.preventDefault()
var t=e.which
t===a.right?s.increment():t===a.left&&s.decrement(),s.$apply()}})},template:'<div class="input-group">  <span class="input-group-btn" ng-show="!verticalButtons">    <button class="btn btn-default" ng-mousedown="startSpinDown()" ng-mouseup="stopSpin()"><i class="fa fa-minus"></i></button>  </span>  <span class="input-group-addon" ng-show="prefix" ng-bind="prefix"></span>  <input type="text" ng-model="val" class="form-control" ng-blur="checkValue()" ng-focus="focus()">  <span class="input-group-addon" ng-show="postfix" ng-bind="postfix"></span>  <span class="input-group-btn" ng-show="!verticalButtons">    <button class="btn btn-default" ng-mousedown="startSpinUp()" ng-mouseup="stopSpin()"><i class="fa fa-plus"></i></button>  </span></div>'}}])
